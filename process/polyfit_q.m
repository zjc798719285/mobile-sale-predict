clc
clear
load('q1_2017.mat')
load('q1_2016.mat')
load('q1_2015.mat')
load('q1_2014.mat')
x_2017=[27,1:89];x_2016=[38,1:91];
x_2015=[49,1:90];x_2014=[30,1:90];
y_2017=q1_2017(:,2)';%/sum(q1_2017(:,2)');
y_2016=q1_2016(:,2)';%/sum(q1_2016(:,2)');
y_2015=q1_2015(:,2)';%/sum(q1_2015(:,2)');
y_2014=q1_2014(:,2)';%/sum(q1_2014(:,2)');
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
c_base_2014=[0.03;137.96;0.004;1.23;49.97;0;0;0.001;-0.01]';
c_2014=nlinfit(x_2014,y_2014,@fit_q_base,c_base_2014);
[py_2014,py1_2014,py2_2014,py3_2014]=fit_q_base2(c_2014,x_2014);
figure(1)
subplot(211)
plot(y_2014,'k');hold on;plot(py_2014)
%plot(py1_2014,'r')%;plot(py2_2014,'g');plot(py3_2014,'m');
subplot(212)
plot(py_2014-y_2014,'r')
title('2014年第一季度预测与残差')
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
c_base_2015=c_2014;
c_2015=nlinfit(x_2015,y_2015,@fit_q_base,c_base_2015);
py_2015=fit_q_base(c_2015,x_2015);
figure(2)
subplot(211)
plot(y_2015,'k');hold on;plot(py_2015)
subplot(212)
plot(py_2015-y_2015,'r')
title('2015年第一季度预测与残差')
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
c_base_2016=c_2015;
c_2016=nlinfit(x_2016,y_2016,@fit_q_base,c_base_2016);
py_2016=fit_q_base(c_2016,x_2016);
figure(3)
subplot(211)
plot(y_2016,'k');hold on;plot(py_2016)
subplot(212)
plot(py_2016-y_2016,'r')
title('2016年第一季度预测与残差')
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
c_base_2017=c_2016;
c_2017=nlinfit(x_2017,y_2017,@fit_q_base,c_base_2017);
py_2017=fit_q_base(c_2017,x_2017);
figure(4)
subplot(211)
plot(y_2017,'k');hold on;plot(py_2017)
subplot(212)
plot(py_2017-y_2017,'r')
title('2017年第一季度预测与残差')
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
para=[c_2014',c_2015',c_2016',c_2017'];
avg_para=mean(para')';
